#!/bin/sh

completed_torrent=$(transmission-remote -n "$USER" -l | awk '$6 == "100%" {print $1}')
if [ -n "$completed_torrent" ]; then
    transmission-remote -n "$USER" -t "$completed_torrent" -r
    notify-send "✅ Transmission-daemon" "Torrent(s) ${completed_torrent} has completed downloading. Deleting torrent files."
    [ -z "$(transmission-remote -n "$USER" -l | grep -v "Sum:" | grep -v "100%")" ] && killall transmission-daemon && notify-send "❌ transmission-daemon disabled."
fi
